Perfect â€” you already have a clear and detailed concept for your **long-term trading web application based on the Kostolany Egg Theory**. Below is a **structured Product Requirement Document (PRD) draft** based on your requirements. It organizes your ideas into standard PRD sections so itâ€™s ready for your development roadmap or team collaboration on GitHub, Notion, or ClickUp.

---

# ðŸ¥š Product Requirement Document (PRD)

## Project Title

**Kostolany Egg Web Application (12.5 Theory Trading System)**

## Document Version

**Draft v0.90.2**

## Author

Austin Chang

## Date

2025-11-07

---

## 1. Product Overview

### 1.1 Purpose

This web application assists traders in managing long-term trading strategies based on **Kostolanyâ€™s Egg Theory**. It integrates **technical indicators** (daily and weekly) and **automated data flow** to identify entry and exit points for long-term investment decisions.

### 1.2 Objectives

* Automate data updates from TWSE (Taiwan Stock Exchange) API.
* Evaluate trading signals using multi-timeframe technical indicators.
* Visualize and manage â€œMain 100â€ stocks and custom â€œTarget Listsâ€ in a Notion-like interface.
* Judge the **Egg Phase** (Y, A1â€“A3, X, B1â€“B3) automatically based on weekly data.
* Enable chatbot-assisted interaction and data querying.

---

## 2. Core Features

### 2.1 Kostolany Egg Theory Engine

* Implements **Kostolany Egg (12.5) Phases**:

  * **Bullish cycle:** Y â†’ A1 â†’ A2 â†’ A3
  * **Bearish cycle:** X â†’ B1 â†’ B2 â†’ B3
* Determined using **weekly technical indicators**.
* Outputs **phase judgment results** and phase transition logs.

---

### 2.2 Technical Indicator Modules

| Timeframe       | Indicators                                | Description                    |
| --------------- | ----------------------------------------- | ------------------------------ |
| **Daily**       | MA2, MA10, MA50, MA132                    | Simple Moving Averages (SMA)   |
| **Weekly**      | MA2, MA10, MA26                           | Weekly trend reference         |
| **SAR**         | High/Low dots & count                     | Indicates momentum reversal    |
| **MA Cross**    | 2-MA crossover or crossunder detection    | Triggers entry/exit points     |
| **MA Slope**    | Positive/negative slope                   | Indicates uptrend or downtrend |
| **Cross Count** | Counts number of bars since last MA cross | Used to assess signal age      |

#### Outputs:

* XO/XU (cross over / cross under) signals
* Slope sign (+ or âˆ’)
* Cross count since last event

---

### 2.3 Daily Flow Automation (Dev Flow)

| Time            | Task                     | Description                                                             |
| --------------- | ------------------------ | ----------------------------------------------------------------------- |
| **8:40 AM**     | Clear previous VV100     | Move yesterdayâ€™s â€œVolume Value 100â€ list to archive; reset todayâ€™s list |
| **9:00 AM**     | Start trading            | TWSE API fetch begins                                                   |
| **9:03 AM**     | Initialize VV100 display | Show top 100 stocks ordered by volume value                             |
| **Every 30 min** | Update VV100 order       | Refresh ranking automatically (Default 30 min for avoid frequent false alarm) (5 min as option)                                          |
| **1:30 PM**     | End trading              | Freeze live updates                                                     |
| **2:30 PM Monâ€“Fri**     | auto-sync trading data             | Automatically triggers sync task no matter if any user opens the app or not                                |

#### Implementation

* `scheduler.ts` automates all above time-triggered processes using `node-cron`.
* Backend updates stored in SQL or NoSQL DB for later analytics.

---

### 2.4 Display Matrix (Notion-like UI)

#### 3.1 Main Matrix

* Displays **Main 100 (VV100)** in grid format.
* Each record includes TWSE stock data and custom indicators.

#### 3.2 Target Lists

* Up to **6 target lists** for categorized monitoring.
* Each list can be edited or updated from the matrix via right-click or drag/drop.

#### 3.3 Fields

* Default TWSE fields (e.g., stock name, price, volume, change, % change, etc.)
* Additional computed fields (e.g., MA slope, SAR count, phase result).

---

### 2.5 Notion-like Field Interaction

| Interaction               | Description                                     |
| ------------------------- | ----------------------------------------------- |
| **Insert**                | Add new technical objects (from right click pull-down menu) |
| **Delete**                | Remove selected field or record                 |
| **Move Forward/Backward** | Reorder fields or lists                         |
| **Right-Click on Field**  | Context menu for additional actions             |
| **Target List Actions**   | Copy stock to target list from pull-down menu   |
| **Other Field Actions**   | Mark Ascent/Descent state by right click pull-down menu    |

---

### 2.6 Chatbot Features (Low Priority)

| Feature             | Description                                                                  |
| ------------------- | ---------------------------------------------------------------------------- |
| **Group Chatbot**   | Supports multiple channels (analyst, data bot, etc.)                         |
| **Service Chatbot** | Responds to user queries like â€œShow todayâ€™s VV100â€ or â€œWhich phase is 2330?â€ |
| **Integration**     | Connects to matrix data, trading logs, and indicators for AI-based answers   |

---

## 3. System Architecture Overview

### 3.1 Frontend

* **Framework:** React (Next.js or Vite)
* **UI Library:** TailwindCSS + shadcn/ui
* **Features:**

  * Real-time matrix dashboard
  * Notion-style drag-and-drop
  * Chart components (e.g., TradingView Widget, Recharts, or Chart.js)
  * Chatbot interface

### 3.2 Backend

* **Runtime:** Node.js (Express or NestJS)
* **Modules:**

  * `scheduler.ts` for daily automation
  * `twseService.ts` for API fetch
  * `technicalEngine.ts` for indicator calculation
  * `eggJudge.ts` for Kostolany Egg phase logic

### 3.3 Database

* **SQL Server** (already connected in VS Code)
* Tables:

  * `VV100_Daily`
  * `VV100_History`
  * `Technical_Indicators`
  * `Egg_Phase_Judge`
  * `Target_Lists`

### 3.4 Integration

* **TWSE API:** For real-time and historical data
* **Chatbot Engine:** RAG + LLM (e.g., GPT-5 API or local model)
* **Cloud/Server:** Optional deployment to AWS / Azure / Railway

---

## 4. Key Algorithms

1. **Moving Average Crossover Detection**

  
   XO = MA_short(t) crosses above MA_long(t) 

   XU = MA_short(t) crosses below MA_long(t)

   Record date/time and cross count since event.

2. **Slope Calculation**

   slope = (MA(t) - MA(t-1))

   If slope > 0 â†’ Uptrend; < 0 â†’ Downtrend

3. **SAR Dot Counting**
   Count consecutive SAR high or low dots to assess momentum persistence.

4. **Egg Phase Judgment**
   Weekly indicators decide phase transitions:

   * Y â†’ when long-term MA crosses up with positive slope
   * A1â€“A3 â†’ progressive bullish stage
   * X â†’ when long-term MA flattens and reverses
   * B1â€“B3 â†’ bearish decline stages

---

## 5. User Roles

| Role        | Description                                              |
| ----------- | -------------------------------------------------------- |
| **Admin**   | Manages system parameters, scheduler, and user roles     |
| **Trader**  | Uses technical indicators and matrix UI                  |
| **Analyst** | Uses chatbot and Egg phase tools for strategy discussion |
| **Viewer**  | Read-only access to data and matrix                      |

---

## 6. Future Enhancements (Low Priority)

* Integration with brokerage APIs for simulated or real trading
* Mobile app with push notifications
* Performance dashboard for ROI tracking
* AI prediction module using TensorFlow or PyTorch models

---

## 7. Milestones

| Phase  | Deliverable                                          | Target Date |
| ------ | ---------------------------------------------------- | ----------- |
| **M1** | Backend architecture + TWSE data sync (scheduler.ts) | Dec 2025    |
| **M2** | Technical indicator engine + database schema         | Jan 2026    |
| **M3** | Frontend matrix UI + Notion-like interactions        | Feb 2026    |
| **M4** | Chatbot integration + Egg phase logic                | Mar 2026    |
| **M5** | Beta testing + Dashboard enhancement                 | Apr 2026    |

---

Would you like me to follow up by generating a **system architecture diagram (frontend + backend + scheduler + database + chatbot)** for this PRD next?
It will help visualize how all these modules connect.
